<h2>Détail de la Stratégie : {{ strategy?.name }}</h2>

<div class="graph-container small-chart">
  <h3>Trade #{{ currentTradeIndex + 1 }} / {{ trades.length }}</h3>

  <div class="chart-wrapper">
    <app-trade-candlestick-chart
      [tradeId]="currentTrade?.id"
      [timeframe]="'5min'"
      [symbol]="strategy?.symbol"
      [comparedSymbol]="strategy?.comparedSymbol">
    </app-trade-candlestick-chart>
  </div>

  <button (click)="nextTrade()" [disabled]="currentTradeIndex >= trades.length - 1">Trade Suivant</button>
</div>


<!-- Message si aucun trade -->
<div *ngIf="trades.length === 0">
  <p>Aucun trade disponible pour cette stratégie.</p>
</div>

<!-- Résumé de la stratégie -->
<div class="strategy-summary">
  <h3>Résumé de la Stratégie</h3>
  <table>
    <tr><td>ID :</td><td>{{ strategy.runId || '-' }}</td></tr>
    <tr><td>Nom :</td><td>{{ strategy?.name }}</td></tr>
    <tr><td>Symbole :</td><td>{{ strategy?.symbol }}</td></tr>
    <tr><td>Compared Symbol :</td><td>{{ strategy?.comparedSymbol }}</td></tr>
    <tr><td>Début :</td><td>{{ strategy?.startDate | date:'short' }}</td></tr>
    <tr><td>Fin :</td><td>{{ strategy?.endDate | date:'short' }}</td></tr>
    <tr><td>Winrate :</td><td>{{ strategy?.winRate }}%</td></tr>
    <tr><td>RR Moyen :</td><td>{{ strategy?.averageRR | number:'1.2-2' }}</td></tr>
    <tr><td>Nombre de trades :</td><td>{{ strategy?.tradeCount ?? trades.length }}</td></tr>
    <tr><td>Trades gagnants :</td><td>{{ strategy?.winningTrades }}</td></tr>
    <tr><td>Trades perdants :</td><td>{{ strategy?.losingTrades }}</td></tr>
    <tr><td>Total Return :</td><td>{{ strategy?.totalReturn | number:'1.2-2' }}</td></tr>
    <tr><td>Max Drawdown :</td><td>{{ strategy?.maxDrawdown | percent:'1.2-2' }}</td></tr>
    <tr><td>Average Trade :</td><td>{{ strategy?.averageTrade | number:'1.2-2' }}</td></tr>
    <tr><td>Average TP :</td><td>{{ strategy?.averageTP | number:'1.2-2' }}</td></tr>
    <tr><td>Average SL :</td><td>{{ strategy?.averageSL | number:'1.2-2' }}</td></tr>
  </table>
</div>

<!-- Détail du trade actif -->
<div class="trade-detail" *ngIf="currentTrade">
  <h3>Détail du Trade Actuel</h3>
  <table>
    <tr><td>ID :</td><td>{{ currentTrade.id }}</td></tr>
    <tr><td>Type :</td><td>{{ currentTrade.tradeType || currentTrade.type }}</td></tr>
    <tr><td>Date d'entrée :</td><td>{{ currentTrade.entryTimestamp || currentTrade.entryDate | date:'short' }}</td></tr>
    <tr><td>Prix d'entrée :</td><td>{{ currentTrade.entryPrice }}</td></tr>
    <tr><td>Prix de sortie :</td><td>{{ currentTrade.exitPrice }}</td></tr>
    <tr><td>Stop Loss :</td><td>{{ currentTrade.stopLoss || 'N/A' }}</td></tr>
    <tr><td>Take Profit :</td><td>{{ currentTrade.takeProfit || 'N/A' }}</td></tr>
    <tr><td>Résultat :</td><td>
      {{ currentTrade.result || (currentTrade.profitOrLoss * 10000 | number:'1.0-0') + ' pips' }}
    </td></tr>
    <tr><td>RR :</td><td>{{ currentTrade.rr || 'Calculé plus tard' }}</td></tr>
    <tr><td>Durée :</td><td>{{ currentTrade.duration || 'Calculé plus tard' }}</td></tr>
    <tr><td>Commentaire :</td><td>{{ currentTrade.comment || '-' }}</td></tr>
  </table>
</div>

